---
description: Правила развертывания инфраструктуры в Astra Linux с OpenNebula и ALD Pro
alwaysApply: true
---

# Инфраструктура (Terraform)

Выполни инициализацию и применение конфигурации для OpenNebula.

При ошибках анализируй вывод terraform apply и проверяй корректность параметров ВМ (сеть, образы, квоты).

## Связка инструментов

Сформируй инвентарь для Ansible (hosts.ini/yml), используя данные из terraform output или состояния (tfstate).

Обеспечь SSH-доступ к созданным узлам перед запуском конфигурации.

## Конфигурация (Ansible)

Запусти плейбуки для настройки системы и установки компонентов ALD Pro.

Используй только штатные модули Ansible (apt, template, systemd, command).

При падении тасок анализируй stderr и логи в /var/log/ на целевых машинах.

## Валидация (Healthcheck)

Проверяй успешность ввода в домен через стандартные системные вызовы: проверку статуса сервисов через systemctl, наличие Kerberos-билетов или получение информации о домене.

Проверяй сетевую связность и доступность портов штатными средствами ОС.

## Отладка и фиксация

Итеративно исправляй ошибки в коде Terraform или плейбуках Ansible до успешного завершения всех этапов.

Создай файл debug_log.md, где тезисно перечисли: возникшую проблему, изученный лог и предпринятое действие.

Действуй автономно: Читай файлы, запускай команды развертывания, анализируй логи выполнения и вноси правки в код.
