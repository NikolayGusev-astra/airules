# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ AIRules ü§ñ

## –î–∏–∞–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```mermaid
graph TD
    A[üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å<br/>–ó–∞–¥–∞—á–∞] --> B{–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π<br/>–†–µ–∂–∏–º<br/>–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏}

    B --> C[üìã –§–ê–ó–ê 1: ARCHITECT<br/>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ]

    C --> C1[üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è<br/>git status<br/>PROJECT_STATE.md<br/>SYSTEM_INSTRUCTION.md<br/>IMPLEMENTATION_PLAN.md]

    C1 --> C2[üîç –ê–Ω–∞–ª–∏–∑<br/>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤<br/>Node.js vs Python]

    C2 --> C3[üìù –†–µ—à–µ–Ω–∏–µ<br/>–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞<br/>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫<br/>NUMERIC(15,2)]

    C3 --> C4[üìÑ –°–æ–∑–¥–∞–Ω–∏–µ<br/>docs/TASK_SPEC.md]

    C4 --> D[‚ö° –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô<br/>–ü–ï–†–ï–•–û–î]

    D --> E[üíª –§–ê–ó–ê 2: EXECUTOR<br/>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ]

    E --> E1[üìñ –ö–æ–Ω—Ç–µ–∫—Å—Ç<br/>–ü–ª–∞–Ω –∏–∑ –§–∞–∑—ã 1<br/>ACCOUNTING_CONSTITUTION.md]

    E1 --> E2[üîç Context7<br/>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö<br/>–±–∏–±–ª–∏–æ—Ç–µ–∫/API]

    E2 --> E3[‚úçÔ∏è –ö–æ–¥–∏–Ω–≥<br/>TypeScript/Node.js<br/>Supabase, Exceljs<br/>NUMERIC(15,2)]

    E3 --> E4{üê∞ Rabbit Hole<br/>Detection<br/>–û—à–∏–±–∫–∞ > 2 —Ä–∞–∑?}

    E4 -->|–î–∞| E5[‚õî –°–¢–û–ü<br/>PROJECT_STATE.md<br/>–¢—Ä–µ–±—É–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫]

    E4 -->|–ù–µ—Ç| E6[‚úÖ –ö–æ–¥ –≥–æ—Ç–æ–≤<br/>git commit]

    E6 --> F[‚ö° –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô<br/>–ü–ï–†–ï–•–û–î]

    F --> G[üîç –§–ê–ó–ê 3: VALIDATOR<br/>–ö–æ–Ω—Ç—Ä–æ–ª—å]

    G --> G1[üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ Checklist<br/>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫<br/>–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö<br/>SQL RLS<br/>–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è<br/>Context7 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ]

    G1 --> G2{‚ùå –û–®–ò–ë–ö–ò<br/>–ù–ê–ô–î–ï–ù–´?}

    G2 -->|–î–∞| G3[‚õî VALIDATION FAILED<br/>–í–æ–∑–≤—Ä–∞—Ç –∫ –§–ê–ó–ï 2<br/>–ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏]

    G2 -->|–ù–µ—Ç| G4[‚úÖ VALIDATION PASSED<br/>PROJECT_STATE.md<br/>git commit]

    G4 --> H[üéâ –ó–ê–î–ê–ß–ê<br/>–í–´–ü–û–õ–ù–ï–ù–ê]

    %% –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
    classDef phaseClass fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef successClass fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef errorClass fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef autoClass fill:#fff3e0,stroke:#ef6c00,stroke-width:2px

    class C,E,G phaseClass
    class G4,H successClass
    class E5,G3 errorClass
    class D,F autoClass
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–æ–ª–µ–π

```mermaid
graph LR
    subgraph "ü§ñ –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è –°–∏—Å—Ç–µ–º–∞"
        subgraph "üë• –†–æ–ª–∏"
            A1[üß† ARCHITECT<br/>–°—Ç–∞—Ä—à–∏–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä<br/>–°–æ–∑–¥–∞–µ—Ç –¢–ó]
            A2[üíª EXECUTOR<br/>Middle Backend Dev<br/>–ü–∏—à–µ—Ç –∫–æ–¥]
            A3[üîç VALIDATOR<br/>–ñ–µ—Å—Ç–∫–∏–π QA<br/>–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥]
            A4[üìö CONTEXT7 RESEARCHER<br/>–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å<br/>–ê–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è]
        end

        subgraph "üîÑ –§–∞–∑—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è"
            P1[üìã –§–ê–ó–ê 1<br/>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ]
            P2[‚öôÔ∏è –§–ê–ó–ê 2<br/>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ]
            P3[‚úÖ –§–ê–ó–ê 3<br/>–í–∞–ª–∏–¥–∞—Ü–∏—è]
        end
    end

    A1 --> P1
    A2 --> P2
    A3 --> P3
    A4 -.-> P1
    A4 -.-> P2

    %% –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
    classDef roleClass fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    classDef phaseClass fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px

    class A1,A2,A3,A4 roleClass
    class P1,P2,P3 phaseClass
```

## –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π

```mermaid
mindmap
  root((ü§ñ AIRules<br/>–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å))
    –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä
      –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
        –°–æ–∑–¥–∞–Ω–∏–µ –¢–ó
        –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–∫–∞
        –ü—Ä–æ–≤–µ—Ä–∫–∞ Context7
      –ó–∞–ø—Ä–µ—Ç—ã
        –ù–ï –ø–∏—à–µ—Ç –∫–æ–¥
        –ù–ï —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç
    –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫
      –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
        TypeScript/Node.js
        Supabase + Exceljs
        NUMERIC(15,2)
        Context7 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
      –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
        Rabbit Hole detection
        –ú–∞–∫—Å–∏–º—É–º 2 –ø–æ–ø—ã—Ç–∫–∏
    –í–∞–ª–∏–¥–∞—Ç–æ—Ä
      –ö–æ–Ω—Ç—Ä–æ–ª—å
        Stack validation
        Type checking
        SQL policies
        Accounting rules
        Context7 verification
      –î–µ–π—Å—Ç–≤–∏—è
        PASS ‚Üí git commit
        FAIL ‚Üí –≤–æ–∑–≤—Ä–∞—Ç –∫ dev
    Context7 Researcher
      –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
        –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
        API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
        –í–µ—Ä—Å–∏–∏
        –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
      –ö–∞—á–µ—Å—Ç–≤–æ
        High reputation
        Benchmark score
        Code snippets
```

## –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

```mermaid
flowchart TD
    START([–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞]) --> DECIDE{–¢–∏–ø –∑–∞–¥–∞—á–∏}

    DECIDE -->|–ù–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞/API| CONTEXT7[üîç Context7 Researcher<br/>resolve-library-id<br/>query-docs]
    DECIDE -->|–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞| ARCHITECT[üß† Architect<br/>–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞<br/>TASK_SPEC.md]

    CONTEXT7 --> ARCHITECT

    ARCHITECT --> EXECUTOR[üíª Executor<br/>–ö–æ–¥–∏–Ω–≥ –ø–æ –ø–ª–∞–Ω—É<br/>TypeScript/Node.js]

    EXECUTOR --> RABBIT{Rabbit Hole?<br/>–û—à–∏–±–∫–∞ 2+ —Ä–∞–∑–∞}

    RABBIT -->|–î–∞| HUMAN[üë§ –¢—Ä–µ–±—É–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫<br/>PROJECT_STATE.md]

    RABBIT -->|–ù–µ—Ç| VALIDATOR[üîç Validator<br/>–ñ–µ—Å—Ç–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞]

    VALIDATOR --> RESULT{–†–µ–∑—É–ª—å—Ç–∞—Ç<br/>–≤–∞–ª–∏–¥–∞—Ü–∏–∏}

    RESULT -->|PASS ‚úÖ| COMMIT[git commit<br/>PROJECT_STATE.md<br/>–ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞]

    RESULT -->|FAIL ‚ùå| EXECUTOR

    COMMIT --> END([‚úÖ –ì–æ—Ç–æ–≤–æ])

    %% –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
    classDef decisionClass fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef successClass fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef errorClass fill:#ffebee,stroke:#c62828,stroke-width:2px

    class DECIDE,RABBIT,RESULT decisionClass
    class COMMIT,END successClass
    class HUMAN errorClass
```

## –õ–µ–≥–µ–Ω–¥–∞ –∏ –ø—Ä–∞–≤–∏–ª–∞

### üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- **3 —Ñ–∞–∑—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - ARCHITECT ‚Üí EXECUTOR ‚Üí VALIDATOR
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—ã** - –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **–ñ–µ—Å—Ç–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - FAIL –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫ EXECUTOR
- **Rabbit Hole –∑–∞—â–∏—Ç–∞** - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö

### üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫**: Node.js only, NUMERIC(15,2), Supabase
- **–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞**: Expense vs Transfer, –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞
- **Context7 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –Ω–µ—Ç NEW/OLD –≤ RLS, type safety

### üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞
- **–ó–ê–ü–†–ï–©–ï–ù–û**: Python, Float/Double, —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ API
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: Context7 –¥–ª—è –Ω–æ–≤—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
- **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò**: –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Ñ–∞–∑–∞–º–∏
- **–ñ–ï–°–¢–ö–û**: –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö

---
*–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –º–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç–Ω–æ–π —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ AIRules* üé®
